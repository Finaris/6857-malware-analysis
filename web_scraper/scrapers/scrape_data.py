import os
import pickle
import json

from aa419_scraper import Aa419Scraper 
from botnets_scraper import BotnetsScraper 
from general_malware_scraper import GeneralMalwareScraper
from hosts_file_net_scraper import HostsFileNetScraper
from malcode_scraper import MalcodeScraper
from mdl_scraper import MdlScraper
from phishing_scraper import PhishingScraper
from ransomware_scraper import RansomwareScraper
from spyware_scraper import SpywareScraper
from squid_blacklist_scraper import SquidBlacklistScraper
from sslbl_scraper import SSLBLScraper
from urlhaus_scraper import URLHausScraper
from viruses_scraper import VirusesScraper
from zeus_scraper import ZeusScraper

scrapers = [x for x in os.listdir() if "_scraper.py" in x]

# scraper1 = Aa419Scraper()
scraper2 = BotnetsScraper()
scraper3 = GeneralMalwareScraper()
scraper4 = HostsFileNetScraper()
scraper5 = MalcodeScraper()
scraper6 = MdlScraper()
scraper7 = PhishingScraper()
scraper8 = RansomwareScraper()
scraper9 = SpywareScraper()
scraper10 = SquidBlacklistScraper()
scraper11 = SSLBLScraper()
scraper12 = URLHausScraper()
scraper13 = VirusesScraper()
scraper14 = ZeusScraper()

for i in range(2, 15):
	scraper = eval("scraper" + str(i))
	scraper.scrape()
	print("Finished scraping " + scraper.__class__.__name__)
	records = scraper.records

	records_list = []
	for page in records:
		records_list.extend(records[page])

	with open('raw_output/pickle_data/' + scraper.__class__.__name__ + ".pickle", 'wb') as filename_data:
		pickle.dump(records_list, filename_data, protocol=pickle.HIGHEST_PROTOCOL)
	print("Pickled " + scraper.__class__.__name__)
	with open('raw_output/json_data/' + scraper.__class__.__name__ + ".json", 'w') as filename_json:
		json.dump(records_list, filename_json)
	print("Json encoded " + scraper.__class__.__name__)



